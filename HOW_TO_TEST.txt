╔════════════════════════════════════════════════════════════════════════════╗
║                    КАК ПРОТЕСТИРОВАТЬ БОТА                                  ║
╚════════════════════════════════════════════════════════════════════════════╝

✅ БОТ ЗАПУЩЕН И РАБОТАЕТ!

═══════════════════════════════════════════════════════════════════════════

🎯 ВАЖНО ПОНЯТЬ:

Бот обрабатывает только НОВЫЕ файлы, которые появятся в канале ПОСЛЕ его запуска.
Он НЕ обрабатывает старые файлы автоматически.

═══════════════════════════════════════════════════════════════════════════

📊 СПОСОБЫ ТЕСТИРОВАНИЯ:

┌─────────────────────────────────────────────────────────────────────────┐
│ СПОСОБ 1: Обработать последние файлы (одноразово)                       │
└─────────────────────────────────────────────────────────────────────────┘

1. Остановите бота (Ctrl+C)

2. Добавьте в .env файл:
   PROCESS_RECENT_ON_START=true
   PROCESS_RECENT_LIMIT=10

3. Перезапустите бота:
   ./start_unified_bot.sh

4. Бот обработает последние 10 файлов из канала и отправит в ваш канал

5. После проверки верните обратно:
   PROCESS_RECENT_ON_START=false
   (чтобы при следующем запуске не дублировать)

┌─────────────────────────────────────────────────────────────────────────┐
│ СПОСОБ 2: Отправить новый файл в канал (рекомендуется)                  │
└─────────────────────────────────────────────────────────────────────────┘

1. Бот уже работает и мониторит канал

2. Отправьте Excel файл в канал XtremeCase
   (или попросите кого-то отправить)

3. В течение 3 часов бот:
   ✅ Обнаружит новый файл
   ✅ Скачает его
   ✅ Применит наценку +200₽
   ✅ Отправит в ваш целевой канал

4. Проверьте логи в реальном времени:
   tail -f bot.log

═══════════════════════════════════════════════════════════════════════════

📝 ЧТО СМОТРЕТЬ В ЛОГАХ:

Успешная обработка выглядит так:

  📡 Проверка новых сообщений в канале: -1001751022775
  Получено сообщений: 20
  🆕 Найдено новое сообщение ID: 123456, дата: 2025-10-20...
  Обнаружен новый файл: Benks_Price.xlsx
  Скачивание файла: Benks_Price.xlsx
  ✔ Файл скачан: /temp/20251020_123456_Benks_Price.xlsx
  🔵 ОБРАБОТКА XTREME CASE: Benks_Price.xlsx
  Процессор: XtremeCaseProcessor
  Наценка: +200 руб.
  ✔ Файл успешно обработан
  Отправка в целевой канал: Benks_Price_Update.xlsx
  ✔ Файл отправлен в канал
  ✅ Обработано новых файлов: 1

═══════════════════════════════════════════════════════════════════════════

🔍 ПРОВЕРКА ЦЕЛЕВОГО КАНАЛА:

1. Откройте ваш целевой канал в Telegram
   ID: -1002605280454

2. Должны появиться обработанные файлы с подписью:
   
   ✅ Прайс обработан
   
   📂 Источник: XtremeCase
   📄 Файл: Benks_Price.xlsx
   💰 Наценка: +200 руб.
   🕐 Время: 2025-10-20 12:34:56

═══════════════════════════════════════════════════════════════════════════

⏱️ ИНТЕРВАЛ ПРОВЕРКИ:

Бот проверяет канал каждые 3 часа.
Можете изменить в .env:

TELEGRAM_CHECK_INTERVAL=30    # Проверять каждые 30 секунд
TELEGRAM_CHECK_INTERVAL=120   # Проверять каждые 2 минуты

═══════════════════════════════════════════════════════════════════════════

🆘 ЕСЛИ НЕ РАБОТАЕТ:

1. Проверьте что бот запущен:
   ps aux | grep unified_bot

2. Проверьте логи:
   tail -100 bot.log | grep ERROR

3. Убедитесь что вы подписаны на канал XtremeCase вашим аккаунтом

4. Проверьте ID каналов в .env файле

5. Попробуйте отправить ТЕСТОВЫЙ файл сами в канал

═══════════════════════════════════════════════════════════════════════════

💡 РЕКОМЕНДАЦИЯ:

Для первого теста используйте СПОСОБ 1 (обработать последние файлы).
Это быстро покажет что все работает правильно.

Потом переключайтесь на СПОСОБ 2 (мониторинг новых файлов).

═══════════════════════════════════════════════════════════════════════════

✨ ГОТОВО К ТЕСТИРОВАНИЮ!

═══════════════════════════════════════════════════════════════════════════
